# Automated Skin Disease Diagnosis and Treatment Recommendations

An AI-powered tool for automated identification and explanation of common skin diseases from dermoscopic images, with treatment recommendations generated by a local LLM.

This project combines a deep learning image classifier (MobileNetV2) with Grad-CAM visualizations and an LLM-based medical assistant to provide concise explanations about each diagnosis.

---

## ✨ Features

- ✅ Classifies skin diseases from dermoscopic images:
  - Actinic Keratoses (akiec)
  - Basal Cell Carcinoma (bcc)
  - Benign Keratosis-like Lesions (bkl)
  - Dermatofibroma (df)
  - Melanoma (mel)
  - Melanocytic Nevi (nv)
  - Vascular Lesions (vasc)
  
- ✅ Grad-CAM heatmaps to highlight important image regions
- ✅ Local LLM (Ollama) for treatment explanations
- ✅ Gradio-based user interface
- ✅ Designed for educational and research purposes (not for medical diagnosis)

---

## 📂 Project Structure

```plaintext
skin_disease_detection_project/
├── dataset/                  # Original HAM10000 images + metadata
├── split_data/               # Train/validation split (ignored in production)
├── model/                    # Trained MobileNetV2 model + training scripts
│   ├── mobilenetv2 models/
│   └── model.py
├── gen_ai/                   # Grad-CAM + LLM integration
│   ├── grad_cam.py
│   ├── gen_ai_model.py
├── app.py
├── requirements.txt              
└── README.md
```

---

## 🚀 Quick Start

### 1️⃣ Clone the repo
  ```bash
  git clone https://github.com/dineshm07/Automated-Skin-Disease-Diagnosis-and-Treatment-Recommendations.git
  cd Automated-Skin-Disease-Diagnosis-and-Treatment-Recommendations
  ```

### 2️⃣ Create virtual environment
 ```bash
 python -m venv venv
 venv\Scripts\activate
 ```

### 3️⃣ Install dependencies
  ```bash
  pip install -r requirements.txt
  ```

### 4️⃣ Download trained model
Place the mobilenetv2_model.h5 file in:
  ```bash
  model/mobilenetv2 models/
  ```

### 5️⃣ Run prediction + explanation
  ```bash
  python predict.py --image path/to/image.jpg
  ```

### 6️⃣ Deploy with Gradio 
You can run app.py to launch a web interface.

## ⚙️ LLM Setup

**Local LLM (Ollama)**
Install Ollama from: https://ollama.com/

**Run Ollama locally:**
  ```bash
  ollama pull llama3
  ollama serve
  ```

---

## 🧠 Model
- Base model: MobileNetV2 (pre-trained on ImageNet, fine-tuned on HAM10000)
- Image size: 160x160
- Data augmentation + class balancing used
- Grad-CAM used for visual explanation of predictions

---

## 📊 Example Output

**Prediction**
  ```cpp
  Predicted class: melanoma (92.56%)
  ```

**LLM Explanation**
  ```diff
  About the Disease:
    Melanoma is a dangerous form of skin cancer that originates in melanocytes...

  Causes:
    - Excessive UV exposure
    - Genetic predisposition...

  Remedies:
    - Immediate medical consultation
    - Surgical removal...
  ```

---

  **⚠️ Disclaimer**
    This project is for educational and research purposes only. It is NOT a medical device and should not be used for clinical diagnosis or treatment decisions.

---

## 🙏 Acknowledgments
  - HAM10000 Dataset: https://doi.org/10.1038/sdata.2018.161
  - TensorFlow / Keras
  - Ollama
